<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Danh sách môn học</h2>
    <div>
      <a routerLink="/admin/subjects/search" class="btn btn-success me-2">🔍 Tìm môn học</a>
      <a class="btn btn-primary" [routerLink]="['/admin/subjects/add']">+ Thêm môn học</a>
    </div>
  </div>

  <table class="table table-bordered table-hover table-striped">
    <thead class="table-dark">
      <tr>
        <th>#</th>
        <th>Tên môn</th>
        <th>Tín chỉ</th>
        <th>Số buổi</th>
        <th>Trọng số QT (%)</th>
        <th>Trọng số TP (%)</th>
        <th>Ngày học</th>
        <th>Giờ học</th>
        <th>Ngày thi</th>
        <th>Giờ thi</th>
        <th>Hành động</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let subject of pagedSubjects; index as i">
        <tr>
          <td>{{ (currentPage - 1) * pageSize + i + 1 }}</td>
          <td>{{ subject.name }}</td>
          <td>{{ subject.credit }}</td>
          <td>{{ subject.sessionCount }}</td>
          <td>{{ subject.processWeight }}</td>
          <td>{{ subject.componentWeight }}</td>
          <td>{{ subject.startDate | date: 'dd/MM/yyyy' }}</td>
          <td>{{ subject.studyTime }}</td>
          <td>{{ subject.examDate | date: 'dd/MM/yyyy' }}</td>
          <td>{{ subject.examTime }}</td>
          <td>
            <a [routerLink]="['/admin/subjects/detail', subject.id]" class="btn btn-sm btn-info me-1">Chi tiết</a>
            <a [routerLink]="['/admin/subjects/edit', subject.id]" class="btn btn-sm btn-warning me-1">Sửa</a>
            <button class="btn btn-sm btn-danger" (click)="delete(subject.id)">Xoá</button>
          </td>
        </tr>

        <tr>
          <td colspan="11" class="text-end">
            <a [routerLink]="['/admin/subjects', subject.id, 'students']" class="btn btn-outline-secondary btn-sm me-2">
              👥 Xem sinh viên đã đăng ký
            </a>
            <a [routerLink]="['/admin/subjects', subject.id, 'register-student']" class="btn btn-outline-primary btn-sm">
              ➕ Đăng ký môn học
            </a>
          </td>
        </tr>
      </ng-container>

      <tr *ngIf="subjects.length === 0">
        <td colspan="11" class="text-center">Không có môn học nào.</td>
      </tr>
    </tbody>
  </table>

  <!-- Pagination -->
  <nav *ngIf="totalPages > 1" class="d-flex justify-content-center mt-3">
    <ul class="pagination">
      <li class="page-item" [class.disabled]="currentPage === 1">
        <button class="page-link" (click)="goToPage(currentPage - 1)">«</button>
      </li>

      <li
        class="page-item"
        *ngFor="let page of [].constructor(totalPages); let i = index"
        [class.active]="currentPage === i + 1"
      >
        <button class="page-link" (click)="goToPage(i + 1)">{{ i + 1 }}</button>
      </li>

      <li class="page-item" [class.disabled]="currentPage === totalPages">
        <button class="page-link" (click)="goToPage(currentPage + 1)">»</button>
      </li>
    </ul>
  </nav>
</div>
